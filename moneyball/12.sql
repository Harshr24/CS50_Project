SELECT p.first_name, p.last_name FROM players p JOIN (SELECT perf.player_id, CASE WHEN H > 0 THEN ROUND(s.salary / H, 2) ELSE NULL END AS "dollars_per_hit", CASE WHEN RBI > 0 THEN ROUND(s.salary / RBI, 2) ELSE NULL END AS "dollars_per_RBI" FROM performances perf JOIN (SELECT player_id, salary FROM salaries WHERE year = 2001) s ON perf.player_id = s.player_id WHERE perf.year = 2001 AND (H > 0 OR RBI > 0)) calc ON p.id = calc.player_id ORDER BY p.id;
